{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createDebuggerProxyEndpoint;\nfunction _ws() {\n  var data = _interopRequireDefault(require(\"ws\"));\n  _ws = function _ws() {\n    return data;\n  };\n  return data;\n}\nfunction _cliTools() {\n  var data = require(\"@react-native-community/cli-tools\");\n  _cliTools = function _cliTools() {\n    return data;\n  };\n  return data;\n}\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nfunction createDebuggerProxyEndpoint() {\n  var WebSocketServer = _ws().default.Server;\n  var wss = new WebSocketServer({\n    noServer: true\n  });\n  var debuggerSocket;\n  var clientSocket;\n  function send(dest, message) {\n    if (!dest) {\n      return;\n    }\n    try {\n      dest.send(message);\n    } catch (e) {\n      _cliTools().logger.warn(e);\n    }\n  }\n  var debuggerSocketCloseHandler = function debuggerSocketCloseHandler() {\n    debuggerSocket = null;\n    if (clientSocket) {\n      clientSocket.close(1011, 'Debugger was disconnected');\n    }\n  };\n  var clientSocketCloseHandler = function clientSocketCloseHandler() {\n    clientSocket = null;\n    send(debuggerSocket, JSON.stringify({\n      method: '$disconnected'\n    }));\n  };\n  wss.on('connection', function (socket, request) {\n    var url = request.url;\n    if (url && url.indexOf('role=debugger') > -1) {\n      if (debuggerSocket) {\n        socket.close(1011, 'Another debugger is already connected');\n        return;\n      }\n      debuggerSocket = socket;\n      if (debuggerSocket) {\n        debuggerSocket.onerror = debuggerSocketCloseHandler;\n        debuggerSocket.onclose = debuggerSocketCloseHandler;\n        debuggerSocket.onmessage = function (_ref) {\n          var data = _ref.data;\n          return send(clientSocket, data);\n        };\n      }\n    } else if (url && url.indexOf('role=client') > -1) {\n      if (clientSocket) {\n        clientSocket.onerror = function () {};\n        clientSocket.onclose = function () {};\n        clientSocket.onmessage = function () {};\n        clientSocket.close(1011, 'Another client connected');\n      }\n      clientSocket = socket;\n      clientSocket.onerror = clientSocketCloseHandler;\n      clientSocket.onclose = clientSocketCloseHandler;\n      clientSocket.onmessage = function (_ref2) {\n        var data = _ref2.data;\n        return send(debuggerSocket, data);\n      };\n    } else {\n      socket.close(1011, 'Missing role param');\n    }\n  });\n  return {\n    server: wss,\n    isDebuggerConnected: function isDebuggerConnected() {\n      return !!debuggerSocket;\n    }\n  };\n}","map":{"version":3,"names":["Object","defineProperty","exports","value","default","createDebuggerProxyEndpoint","_ws","data","_interopRequireDefault","require","_cliTools","obj","__esModule","WebSocketServer","Server","wss","noServer","debuggerSocket","clientSocket","send","dest","message","e","logger","warn","debuggerSocketCloseHandler","close","clientSocketCloseHandler","JSON","stringify","method","on","socket","request","url","indexOf","onerror","onclose","onmessage","_ref","_ref2","server","isDebuggerConnected"],"sources":["C:/Users/CR Laptop/Desktop/rn-project/react_navigation/node_modules/@react-native-community/cli-server-api/build/websocket/createDebuggerProxyEndpoint.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = createDebuggerProxyEndpoint;\nfunction _ws() {\n  const data = _interopRequireDefault(require(\"ws\"));\n  _ws = function () {\n    return data;\n  };\n  return data;\n}\nfunction _cliTools() {\n  const data = require(\"@react-native-community/cli-tools\");\n  _cliTools = function () {\n    return data;\n  };\n  return data;\n}\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @format\n */\n\nfunction createDebuggerProxyEndpoint() {\n  const WebSocketServer = _ws().default.Server;\n  const wss = new WebSocketServer({\n    noServer: true\n  });\n  let debuggerSocket;\n  let clientSocket;\n  function send(dest, message) {\n    if (!dest) {\n      return;\n    }\n    try {\n      dest.send(message);\n    } catch (e) {\n      _cliTools().logger.warn(e);\n      // Sometimes this call throws 'not opened'\n    }\n  }\n\n  const debuggerSocketCloseHandler = () => {\n    debuggerSocket = null;\n    if (clientSocket) {\n      clientSocket.close(1011, 'Debugger was disconnected');\n    }\n  };\n  const clientSocketCloseHandler = () => {\n    clientSocket = null;\n    send(debuggerSocket, JSON.stringify({\n      method: '$disconnected'\n    }));\n  };\n  wss.on('connection', (socket, request) => {\n    const {\n      url\n    } = request;\n    if (url && url.indexOf('role=debugger') > -1) {\n      if (debuggerSocket) {\n        socket.close(1011, 'Another debugger is already connected');\n        return;\n      }\n      debuggerSocket = socket;\n      if (debuggerSocket) {\n        debuggerSocket.onerror = debuggerSocketCloseHandler;\n        debuggerSocket.onclose = debuggerSocketCloseHandler;\n        debuggerSocket.onmessage = ({\n          data\n        }) => send(clientSocket, data);\n      }\n    } else if (url && url.indexOf('role=client') > -1) {\n      if (clientSocket) {\n        clientSocket.onerror = () => {};\n        clientSocket.onclose = () => {};\n        clientSocket.onmessage = () => {};\n        clientSocket.close(1011, 'Another client connected');\n      }\n      clientSocket = socket;\n      clientSocket.onerror = clientSocketCloseHandler;\n      clientSocket.onclose = clientSocketCloseHandler;\n      clientSocket.onmessage = ({\n        data\n      }) => send(debuggerSocket, data);\n    } else {\n      socket.close(1011, 'Missing role param');\n    }\n  });\n  return {\n    server: wss,\n    isDebuggerConnected() {\n      return !!debuggerSocket;\n    }\n  };\n}\n\n//# sourceMappingURL=createDebuggerProxyEndpoint.ts.map"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}