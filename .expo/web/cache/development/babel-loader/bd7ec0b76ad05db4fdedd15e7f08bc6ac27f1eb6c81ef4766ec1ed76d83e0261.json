{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.findPnpmWorkspaceRoot = exports.findYarnOrNpmWorkspaceRoot = exports.BUN_LOCK_FILE = exports.PNPM_WORKSPACE_FILE = exports.PNPM_LOCK_FILE = exports.YARN_LOCK_FILE = exports.NPM_LOCK_FILE = void 0;\nvar find_up_1 = require(\"find-up\");\nvar find_yarn_workspace_root_1 = __importDefault(require(\"find-yarn-workspace-root\"));\nvar fs_1 = __importDefault(require(\"fs\"));\nvar js_yaml_1 = __importDefault(require(\"js-yaml\"));\nvar micromatch_1 = __importDefault(require(\"micromatch\"));\nvar path_1 = __importDefault(require(\"path\"));\nexports.NPM_LOCK_FILE = 'package-lock.json';\nexports.YARN_LOCK_FILE = 'yarn.lock';\nexports.PNPM_LOCK_FILE = 'pnpm-lock.yaml';\nexports.PNPM_WORKSPACE_FILE = 'pnpm-workspace.yaml';\nexports.BUN_LOCK_FILE = 'bun.lockb';\nfunction findYarnOrNpmWorkspaceRoot(projectRoot) {\n  try {\n    return (0, find_yarn_workspace_root_1.default)(projectRoot);\n  } catch (error) {\n    if (error.message.includes('Unexpected end of JSON input')) {\n      return null;\n    }\n    throw error;\n  }\n}\nexports.findYarnOrNpmWorkspaceRoot = findYarnOrNpmWorkspaceRoot;\nfunction findPnpmWorkspaceRoot(projectRoot) {\n  var _process$env$workspac;\n  var workspaceEnvName = 'NPM_CONFIG_WORKSPACE_DIR';\n  var workspaceEnvValue = (_process$env$workspac = process.env[workspaceEnvName]) != null ? _process$env$workspac : process.env[workspaceEnvName.toLowerCase()];\n  var workspaceFile = workspaceEnvValue ? path_1.default.join(workspaceEnvValue, exports.PNPM_WORKSPACE_FILE) : (0, find_up_1.sync)(exports.PNPM_WORKSPACE_FILE, {\n    cwd: projectRoot\n  });\n  if (!workspaceFile || !fs_1.default.existsSync(workspaceFile)) {\n    return null;\n  }\n  try {\n    var _js_yaml_1$default$lo = js_yaml_1.default.load(fs_1.default.readFileSync(workspaceFile, 'utf8')),\n      workspaces = _js_yaml_1$default$lo.packages;\n    var workspaceRoot = path_1.default.dirname(workspaceFile);\n    var relativePath = path_1.default.relative(workspaceRoot, projectRoot);\n    if (relativePath === '' || (0, micromatch_1.default)([relativePath], workspaces).length > 0) {\n      return workspaceRoot;\n    }\n  } catch (_unused) {\n    return null;\n  }\n  return null;\n}\nexports.findPnpmWorkspaceRoot = findPnpmWorkspaceRoot;","map":{"version":3,"names":["find_up_1","require","find_yarn_workspace_root_1","__importDefault","fs_1","js_yaml_1","micromatch_1","path_1","exports","NPM_LOCK_FILE","YARN_LOCK_FILE","PNPM_LOCK_FILE","PNPM_WORKSPACE_FILE","BUN_LOCK_FILE","findYarnOrNpmWorkspaceRoot","projectRoot","default","error","message","includes","findPnpmWorkspaceRoot","_process$env$workspac","workspaceEnvName","workspaceEnvValue","process","env","toLowerCase","workspaceFile","join","sync","cwd","existsSync","_js_yaml_1$default$lo","load","readFileSync","workspaces","packages","workspaceRoot","dirname","relativePath","relative","length","_unused"],"sources":["../../src/utils/nodeWorkspaces.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,0BAAA,GAAAC,eAAA,CAAAF,OAAA;AACA,IAAAG,IAAA,GAAAD,eAAA,CAAAF,OAAA;AACA,IAAAI,SAAA,GAAAF,eAAA,CAAAF,OAAA;AACA,IAAAK,YAAA,GAAAH,eAAA,CAAAF,OAAA;AACA,IAAAM,MAAA,GAAAJ,eAAA,CAAAF,OAAA;AAEaO,OAAA,CAAAC,aAAa,GAAG,mBAAmB;AACnCD,OAAA,CAAAE,cAAc,GAAG,WAAW;AAC5BF,OAAA,CAAAG,cAAc,GAAG,gBAAgB;AACjCH,OAAA,CAAAI,mBAAmB,GAAG,qBAAqB;AAC3CJ,OAAA,CAAAK,aAAa,GAAG,WAAW;AAGxC,SAAgBC,0BAA0BA,CAACC,WAAmB;EAC5D,IAAI;IACF,OAAO,IAAAb,0BAAA,CAAAc,OAAgC,EAACD,WAAW,CAAC;GACrD,CAAC,OAAOE,KAAU,EAAE;IACnB,IAAIA,KAAK,CAACC,OAAO,CAACC,QAAQ,CAAC,8BAA8B,CAAC,EAAE;MAC1D,OAAO,IAAI;;IAEb,MAAMF,KAAK;;AAEf;AATAT,OAAA,CAAAM,0BAAA,GAAAA,0BAAA;AAgBA,SAAgBM,qBAAqBA,CAACL,WAAmB;EAAA,IAAAM,qBAAA;EACvD,IAAMC,gBAAgB,GAAG,0BAA0B;EACnD,IAAMC,iBAAiB,IAAAF,qBAAA,GACrBG,OAAO,CAACC,GAAG,CAACH,gBAAgB,CAAC,YAAAD,qBAAA,GAAIG,OAAO,CAACC,GAAG,CAACH,gBAAgB,CAACI,WAAW,EAAE,CAAC;EAE9E,IAAMC,aAAa,GAAGJ,iBAAiB,GACnChB,MAAA,CAAAS,OAAI,CAACY,IAAI,CAACL,iBAAiB,EAAEf,OAAA,CAAAI,mBAAmB,CAAC,GACjD,IAAAZ,SAAA,CAAA6B,IAAU,EAACrB,OAAA,CAAAI,mBAAmB,EAAE;IAAEkB,GAAG,EAAEf;EAAW,CAAE,CAAC;EAEzD,IAAI,CAACY,aAAa,IAAI,CAACvB,IAAA,CAAAY,OAAE,CAACe,UAAU,CAACJ,aAAa,CAAC,EAAE;IACnD,OAAO,IAAI;;EAGb,IAAI;IAEF,IAAAK,qBAAA,GAAiC3B,SAAA,CAAAW,OAAI,CAACiB,IAAI,CAAC7B,IAAA,CAAAY,OAAE,CAACkB,YAAY,CAACP,aAAa,EAAE,MAAM,CAAC,CAAC;MAAhEQ,UAAU,GAAAH,qBAAA,CAApBI,QAAQ;IAEhB,IAAMC,aAAa,GAAG9B,MAAA,CAAAS,OAAI,CAACsB,OAAO,CAACX,aAAa,CAAC;IACjD,IAAMY,YAAY,GAAGhC,MAAA,CAAAS,OAAI,CAACwB,QAAQ,CAACH,aAAa,EAAEtB,WAAW,CAAC;IAE9D,IAAIwB,YAAY,KAAK,EAAE,IAAI,IAAAjC,YAAA,CAAAU,OAAU,EAAC,CAACuB,YAAY,CAAC,EAAEJ,UAAU,CAAC,CAACM,MAAM,GAAG,CAAC,EAAE;MAC5E,OAAOJ,aAAa;;GAEvB,CAAC,OAAAK,OAAA,EAAM;IAEN,OAAO,IAAI;;EAGb,OAAO,IAAI;AACb;AA7BAlC,OAAA,CAAAY,qBAAA,GAAAA,qBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}