{"ast":null,"code":"\"use strict\";\n\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _send = _interopRequireDefault(require(\"send\"));\nvar _url = require(\"url\");\nvar _env = require(\"../../../utils/env\");\nvar _resolvePlatform = require(\"./resolvePlatform\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar debug = require(\"debug\")(\"expo:start:server:middleware:serveStatic\");\nvar ServeStaticMiddleware = function () {\n  function ServeStaticMiddleware(projectRoot) {\n    _classCallCheck(this, ServeStaticMiddleware);\n    this.projectRoot = projectRoot;\n  }\n  _createClass(ServeStaticMiddleware, [{\n    key: \"getHandler\",\n    value: function getHandler() {\n      var publicPath = _path.default.join(this.projectRoot, _env.env.EXPO_PUBLIC_FOLDER);\n      debug(`Serving static files from:`, publicPath);\n      var opts = {\n        root: publicPath\n      };\n      return function (req, res, next) {\n        if (!(req == null ? void 0 : req.url) || req.method !== \"GET\" && req.method !== \"HEAD\") {\n          return next();\n        }\n        var platform = (0, _resolvePlatform).parsePlatformHeader(req);\n        if (platform && platform !== \"web\") {\n          return next();\n        }\n        var pathname = (0, _url).parse(req.url).pathname;\n        if (!pathname) {\n          return next();\n        }\n        debug(`Maybe serve static:`, pathname);\n        var stream = (0, _send).default(req, pathname, opts);\n        var forwardError = false;\n        stream.on(\"file\", function onFile() {\n          forwardError = true;\n        });\n        stream.on(\"error\", function error(err) {\n          if (forwardError || !(err.statusCode < 500)) {\n            next(err);\n            return;\n          }\n          next();\n        });\n        stream.pipe(res);\n      };\n    }\n  }]);\n  return ServeStaticMiddleware;\n}();\nexports.ServeStaticMiddleware = ServeStaticMiddleware;","map":{"version":3,"names":["_classCallCheck","require","_createClass","_path","_interopRequireDefault","_send","_url","_env","_resolvePlatform","debug","ServeStaticMiddleware","projectRoot","key","value","getHandler","publicPath","default","join","env","EXPO_PUBLIC_FOLDER","opts","root","req","res","next","url","method","platform","parsePlatformHeader","pathname","parse","stream","forwardError","on","onFile","error","err","statusCode","pipe"],"sources":["C:\\Users\\CR Laptop\\Desktop\\rn-project\\react_navigation\\node_modules\\@expo\\cli\\src\\start\\server\\middleware\\ServeStaticMiddleware.ts"],"sourcesContent":["import path from 'path';\nimport send from 'send';\nimport { parse } from 'url';\n\nimport { env } from '../../../utils/env';\nimport { parsePlatformHeader } from './resolvePlatform';\nimport { ServerRequest, ServerResponse } from './server.types';\n\nconst debug = require('debug')('expo:start:server:middleware:serveStatic') as typeof console.log;\n\n/**\n * Adds support for serving the files in the static `public/` folder to web apps.\n */\nexport class ServeStaticMiddleware {\n  constructor(private projectRoot: string) {}\n  getHandler() {\n    const publicPath = path.join(this.projectRoot, env.EXPO_PUBLIC_FOLDER);\n\n    debug(`Serving static files from:`, publicPath);\n    const opts = {\n      root: publicPath,\n    };\n    return (req: ServerRequest, res: ServerResponse, next: any) => {\n      if (!req?.url || (req.method !== 'GET' && req.method !== 'HEAD')) {\n        return next();\n      }\n\n      const platform = parsePlatformHeader(req);\n      // Currently this is web-only\n      if (platform && platform !== 'web') {\n        return next();\n      }\n\n      const pathname = parse(req.url).pathname;\n      if (!pathname) {\n        return next();\n      }\n\n      debug(`Maybe serve static:`, pathname);\n      const stream = send(req, pathname, opts);\n\n      // add file listener for fallthrough\n      let forwardError = false;\n      stream.on('file', function onFile() {\n        // once file is determined, always forward error\n        forwardError = true;\n      });\n\n      // forward errors\n      stream.on('error', function error(err: any) {\n        if (forwardError || !(err.statusCode < 500)) {\n          next(err);\n          return;\n        }\n\n        next();\n      });\n\n      // pipe\n      stream.pipe(res);\n    };\n  }\n}\n"],"mappings":"AAAA;;AAAA,IAAAA,eAAA,GAAAC,OAAA;AAAA,IAAAC,YAAA,GAAAD,OAAA;;;;AAAiB,IAAAE,KAAM,GAAAC,sBAAA,CAAAH,OAAA,CAAN,MAAM;AACN,IAAAI,KAAM,GAAAD,sBAAA,CAAAH,OAAA,CAAN,MAAM;AACD,IAAAK,IAAK,GAAAL,OAAA,CAAL,KAAK;AAEP,IAAAM,IAAoB,GAAAN,OAAA;AACJ,IAAAO,gBAAmB,GAAAP,OAAA;;;;;;AAGvD,IAAMQ,KAAK,GAAGR,OAAO,CAAC,OAAO,CAAC,CAAC,0CAA0C,CAAC;AAAuB,IAKpFS,qBAAqB;EAChC,SAAAA,sBAAoBC,WAAmB,EAAE;IAAAX,eAAA,OAAAU,qBAAA;SAArBC,WAAmB,GAAnBA,WAAmB;;EAAIT,YAAA,CAAAQ,qBAAA;IAAAE,GAAA;IAAAC,KAAA,EAC3C,SAAAC,WAAA,EAAa;MACX,IAAMC,UAAU,GAAGZ,KAAI,CAAAa,OAAA,CAACC,IAAI,CAAC,IAAI,CAACN,WAAW,EAAEJ,IAAG,CAAAW,GAAA,CAACC,kBAAkB,CAAC;MAEtEV,KAAK,CAAE,4BAA2B,EAAEM,UAAU,CAAC;MAC/C,IAAMK,IAAI,GAAG;QACXC,IAAI,EAAEN;OACP;MACD,OAAO,UAACO,GAAkB,EAAEC,GAAmB,EAAEC,IAAS,EAAK;QAC7D,IAAI,EAACF,GAAG,QAAK,GAAR,MAAQ,GAARA,GAAG,CAAEG,GAAG,KAAKH,GAAG,CAACI,MAAM,KAAK,KAAK,IAAIJ,GAAG,CAACI,MAAM,KAAK,MAAM,EAAG;UAChE,OAAOF,IAAI,EAAE;;QAGf,IAAMG,QAAQ,GAAG,IAAAnB,gBAAmB,EAAKoB,mBAAL,CAACN,GAAG,CAAC;QAEzC,IAAIK,QAAQ,IAAIA,QAAQ,KAAK,KAAK,EAAE;UAClC,OAAOH,IAAI,EAAE;;QAGf,IAAMK,QAAQ,GAAG,IAAAvB,IAAK,EAASwB,KAAT,CAACR,GAAG,CAACG,GAAG,CAAC,CAACI,QAAQ;QACxC,IAAI,CAACA,QAAQ,EAAE;UACb,OAAOL,IAAI,EAAE;;QAGff,KAAK,CAAE,qBAAoB,EAAEoB,QAAQ,CAAC;QACtC,IAAME,MAAM,GAAG,IAAA1B,KAAI,EAAqBW,OAArB,CAACM,GAAG,EAAEO,QAAQ,EAAET,IAAI,CAAC;QAGxC,IAAIY,YAAY,GAAG,KAAK;QACxBD,MAAM,CAACE,EAAE,CAAC,MAAM,EAAE,SAASC,MAAMA,CAAA,EAAG;UAElCF,YAAY,GAAG,IAAI;SACpB,CAAC;QAGFD,MAAM,CAACE,EAAE,CAAC,OAAO,EAAE,SAASE,KAAKA,CAACC,GAAQ,EAAE;UAC1C,IAAIJ,YAAY,IAAI,EAAEI,GAAG,CAACC,UAAU,GAAG,GAAG,CAAC,EAAE;YAC3Cb,IAAI,CAACY,GAAG,CAAC;YACT;;UAGFZ,IAAI,EAAE;SACP,CAAC;QAGFO,MAAM,CAACO,IAAI,CAACf,GAAG,CAAC;OACjB;;EACF;EAAA,OAAAb,qBAAA;AAAA;QAhDUA,qBAAqB,GAArBA,qBAAqB"},"metadata":{},"sourceType":"script","externalDependencies":[]}