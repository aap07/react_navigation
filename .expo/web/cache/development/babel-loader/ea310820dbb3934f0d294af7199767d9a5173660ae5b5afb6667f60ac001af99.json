{"ast":null,"code":"\"use strict\";\n\nvar _defineProperty = require(\"@babel/runtime/helpers/defineProperty\");\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createForProject = exports.resolvePackageManager = exports.findWorkspaceRoot = exports.RESOLUTION_ORDER = void 0;\nvar fs_1 = __importDefault(require(\"fs\"));\nvar path_1 = __importDefault(require(\"path\"));\nvar BunPackageManager_1 = require(\"../node/BunPackageManager\");\nvar NpmPackageManager_1 = require(\"../node/NpmPackageManager\");\nvar PnpmPackageManager_1 = require(\"../node/PnpmPackageManager\");\nvar YarnPackageManager_1 = require(\"../node/YarnPackageManager\");\nvar nodeWorkspaces_1 = require(\"./nodeWorkspaces\");\nexports.RESOLUTION_ORDER = ['bun', 'yarn', 'npm', 'pnpm'];\nfunction findWorkspaceRoot(projectRoot, preferredManager) {\n  var strategies = {\n    npm: nodeWorkspaces_1.findYarnOrNpmWorkspaceRoot,\n    yarn: nodeWorkspaces_1.findYarnOrNpmWorkspaceRoot,\n    pnpm: nodeWorkspaces_1.findPnpmWorkspaceRoot,\n    bun: nodeWorkspaces_1.findYarnOrNpmWorkspaceRoot\n  };\n  if (preferredManager) {\n    return strategies[preferredManager](projectRoot);\n  }\n  for (var strategy of exports.RESOLUTION_ORDER) {\n    var root = strategies[strategy](projectRoot);\n    if (root) {\n      return root;\n    }\n  }\n  return null;\n}\nexports.findWorkspaceRoot = findWorkspaceRoot;\nfunction resolvePackageManager(projectRoot, preferredManager) {\n  var _findWorkspaceRoot;\n  var root = (_findWorkspaceRoot = findWorkspaceRoot(projectRoot, preferredManager)) != null ? _findWorkspaceRoot : projectRoot;\n  var lockFiles = {\n    npm: nodeWorkspaces_1.NPM_LOCK_FILE,\n    pnpm: nodeWorkspaces_1.PNPM_LOCK_FILE,\n    yarn: nodeWorkspaces_1.YARN_LOCK_FILE,\n    bun: nodeWorkspaces_1.BUN_LOCK_FILE\n  };\n  if (preferredManager) {\n    if (fs_1.default.existsSync(path_1.default.join(root, lockFiles[preferredManager]))) {\n      return preferredManager;\n    }\n    return null;\n  }\n  for (var managerName of exports.RESOLUTION_ORDER) {\n    if (fs_1.default.existsSync(path_1.default.join(root, lockFiles[managerName]))) {\n      return managerName;\n    }\n  }\n  return null;\n}\nexports.resolvePackageManager = resolvePackageManager;\nfunction createForProject(projectRoot) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  if (options.npm) {\n    return new NpmPackageManager_1.NpmPackageManager(_objectSpread({\n      cwd: projectRoot\n    }, options));\n  } else if (options.yarn) {\n    return new YarnPackageManager_1.YarnPackageManager(_objectSpread({\n      cwd: projectRoot\n    }, options));\n  } else if (options.pnpm) {\n    return new PnpmPackageManager_1.PnpmPackageManager(_objectSpread({\n      cwd: projectRoot\n    }, options));\n  } else if (options.bun) {\n    return new BunPackageManager_1.BunPackageManager(_objectSpread({\n      cwd: projectRoot\n    }, options));\n  }\n  switch (resolvePackageManager(projectRoot)) {\n    case 'npm':\n      return new NpmPackageManager_1.NpmPackageManager(_objectSpread({\n        cwd: projectRoot\n      }, options));\n    case 'pnpm':\n      return new PnpmPackageManager_1.PnpmPackageManager(_objectSpread({\n        cwd: projectRoot\n      }, options));\n    case 'yarn':\n      return new YarnPackageManager_1.YarnPackageManager(_objectSpread({\n        cwd: projectRoot\n      }, options));\n    case 'bun':\n      return new BunPackageManager_1.BunPackageManager(_objectSpread({\n        cwd: projectRoot\n      }, options));\n    default:\n      return new NpmPackageManager_1.NpmPackageManager(_objectSpread({\n        cwd: projectRoot\n      }, options));\n  }\n}\nexports.createForProject = createForProject;","map":{"version":3,"names":["fs_1","__importDefault","require","path_1","BunPackageManager_1","NpmPackageManager_1","PnpmPackageManager_1","YarnPackageManager_1","nodeWorkspaces_1","exports","RESOLUTION_ORDER","findWorkspaceRoot","projectRoot","preferredManager","strategies","npm","findYarnOrNpmWorkspaceRoot","yarn","pnpm","findPnpmWorkspaceRoot","bun","strategy","root","resolvePackageManager","_findWorkspaceRoot","lockFiles","NPM_LOCK_FILE","PNPM_LOCK_FILE","YARN_LOCK_FILE","BUN_LOCK_FILE","default","existsSync","join","managerName","createForProject","options","arguments","length","undefined","NpmPackageManager","_objectSpread","cwd","YarnPackageManager","PnpmPackageManager","BunPackageManager"],"sources":["../../src/utils/nodeManagers.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}