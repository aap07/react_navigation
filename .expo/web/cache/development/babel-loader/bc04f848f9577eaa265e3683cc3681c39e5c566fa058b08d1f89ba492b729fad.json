{"ast":null,"code":"\"use strict\";\n\nvar _get = require(\"@babel/runtime/helpers/get\");\nvar _createClass = require(\"@babel/runtime/helpers/createClass\");\nvar _classCallCheck = require(\"@babel/runtime/helpers/classCallCheck\");\nvar _inherits = require(\"@babel/runtime/helpers/inherits\");\nvar _possibleConstructorReturn = require(\"@babel/runtime/helpers/possibleConstructorReturn\");\nvar _getPrototypeOf = require(\"@babel/runtime/helpers/getPrototypeOf\");\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isLockdownResponse = isLockdownResponse;\nexports.isLockdownErrorResponse = isLockdownErrorResponse;\nexports.LOCKDOWN_HEADER_SIZE = void 0;\nvar _plist = _interopRequireDefault(require(\"@expo/plist\"));\nvar _debug = _interopRequireDefault(require(\"debug\"));\nvar _errors = require(\"../../../../utils/errors\");\nvar _abstractProtocol = require(\"./AbstractProtocol\");\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\nvar debug = (0, _debug).default(\"expo:apple-device:protocol:lockdown\");\nvar LOCKDOWN_HEADER_SIZE = 4;\nexports.LOCKDOWN_HEADER_SIZE = LOCKDOWN_HEADER_SIZE;\nfunction isDefined(val) {\n  return typeof val !== \"undefined\";\n}\nfunction isLockdownResponse(resp) {\n  return isDefined(resp.Status);\n}\nfunction isLockdownErrorResponse(resp) {\n  return isDefined(resp.Error);\n}\nvar LockdownProtocolClient = function (_abstractProtocol$Pro) {\n  _inherits(LockdownProtocolClient, _abstractProtocol$Pro);\n  var _super = _createSuper(LockdownProtocolClient);\n  function LockdownProtocolClient(socket) {\n    _classCallCheck(this, LockdownProtocolClient);\n    return _super.call(this, socket, new _abstractProtocol.ProtocolReaderFactory(LockdownProtocolReader), new LockdownProtocolWriter());\n  }\n  return _createClass(LockdownProtocolClient);\n}(_abstractProtocol.ProtocolClient);\nexports.LockdownProtocolClient = LockdownProtocolClient;\nvar LockdownProtocolReader = function (_abstractProtocol$Pli) {\n  _inherits(LockdownProtocolReader, _abstractProtocol$Pli);\n  var _super2 = _createSuper(LockdownProtocolReader);\n  function LockdownProtocolReader(callback) {\n    _classCallCheck(this, LockdownProtocolReader);\n    return _super2.call(this, LOCKDOWN_HEADER_SIZE, callback);\n  }\n  _createClass(LockdownProtocolReader, [{\n    key: \"parseHeader\",\n    value: function parseHeader(data) {\n      return data.readUInt32BE(0);\n    }\n  }, {\n    key: \"parseBody\",\n    value: function parseBody(data) {\n      var resp = _get(_getPrototypeOf(LockdownProtocolReader.prototype), \"parseBody\", this).call(this, data);\n      debug(`Response: ${JSON.stringify(resp)}`);\n      if (isLockdownErrorResponse(resp)) {\n        if (resp.Error === \"DeviceLocked\") {\n          throw new _errors.CommandError(\"APPLE_DEVICE_LOCKED\", \"Device is currently locked.\");\n        }\n        if (resp.Error === \"InvalidService\") {\n          var errorMessage = `${resp.Error}: ${resp.Service} (request: ${resp.Request})`;\n          if (resp.Service === \"com.apple.debugserver\") {\n            errorMessage += \"\\nTry reconnecting your device. You can also debug service logs with `export DEBUG=expo:xdl:ios:*`\";\n          }\n          throw new _errors.CommandError(\"APPLE_DEVICE_LOCKDOWN\", errorMessage);\n        }\n        throw new _errors.CommandError(\"APPLE_DEVICE_LOCKDOWN\", resp.Error);\n      }\n      return resp;\n    }\n  }]);\n  return LockdownProtocolReader;\n}(_abstractProtocol.PlistProtocolReader);\nexports.LockdownProtocolReader = LockdownProtocolReader;\nvar LockdownProtocolWriter = function () {\n  function LockdownProtocolWriter() {\n    _classCallCheck(this, LockdownProtocolWriter);\n  }\n  _createClass(LockdownProtocolWriter, [{\n    key: \"write\",\n    value: function write(socket, plistData) {\n      debug(`socket write: ${JSON.stringify(plistData)}`);\n      var plistMessage = _plist.default.build(plistData);\n      var header = Buffer.alloc(LOCKDOWN_HEADER_SIZE);\n      header.writeUInt32BE(plistMessage.length, 0);\n      socket.write(header);\n      socket.write(plistMessage);\n    }\n  }]);\n  return LockdownProtocolWriter;\n}();\nexports.LockdownProtocolWriter = LockdownProtocolWriter;","map":{"version":3,"names":["_get","require","_createClass","_classCallCheck","_inherits","_possibleConstructorReturn","_getPrototypeOf","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","constructor","Reflect","construct","arguments","apply","sham","Proxy","Boolean","prototype","valueOf","call","e","isLockdownResponse","isLockdownErrorResponse","_plist","_interopRequireDefault","_debug","_errors","_abstractProtocol","debug","default","LOCKDOWN_HEADER_SIZE","isDefined","val","resp","Status","Error","LockdownProtocolClient","_abstractProtocol$Pro","_super","socket","ProtocolReaderFactory","LockdownProtocolReader","LockdownProtocolWriter","ProtocolClient","_abstractProtocol$Pli","_super2","callback","key","value","parseHeader","data","readUInt32BE","parseBody","JSON","stringify","CommandError","errorMessage","Service","Request","PlistProtocolReader","write","plistData","plistMessage","build","header","Buffer","alloc","writeUInt32BE","length"],"sources":["C:\\Users\\CR Laptop\\Desktop\\rn-project\\react_navigation\\node_modules\\@expo\\cli\\src\\run\\ios\\appleDevice\\protocol\\LockdownProtocol.ts"],"sourcesContent":["/**\n * Copyright (c) 2021 Expo, Inc.\n * Copyright (c) 2018 Drifty Co.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport plist from '@expo/plist';\nimport Debug from 'debug';\nimport { Socket } from 'net';\n\nimport { CommandError } from '../../../../utils/errors';\nimport type { ProtocolWriter } from './AbstractProtocol';\nimport { PlistProtocolReader, ProtocolClient, ProtocolReaderFactory } from './AbstractProtocol';\n\nconst debug = Debug('expo:apple-device:protocol:lockdown');\nexport const LOCKDOWN_HEADER_SIZE = 4;\n\nexport interface LockdownCommand {\n  Command: string;\n  [key: string]: any;\n}\n\nexport interface LockdownResponse {\n  Status: string;\n  [key: string]: any;\n}\n\nexport interface LockdownErrorResponse {\n  Error: string;\n  Request?: string;\n  Service?: string;\n}\n\nexport interface LockdownRequest {\n  Request: string;\n  [key: string]: any;\n}\n\nfunction isDefined(val: any) {\n  return typeof val !== 'undefined';\n}\n\nexport function isLockdownResponse(resp: any): resp is LockdownResponse {\n  return isDefined(resp.Status);\n}\n\nexport function isLockdownErrorResponse(resp: any): resp is LockdownErrorResponse {\n  return isDefined(resp.Error);\n}\n\nexport class LockdownProtocolClient<\n  MessageType extends LockdownRequest | LockdownCommand = LockdownRequest\n> extends ProtocolClient<MessageType> {\n  constructor(socket: Socket) {\n    super(socket, new ProtocolReaderFactory(LockdownProtocolReader), new LockdownProtocolWriter());\n  }\n}\n\nexport class LockdownProtocolReader extends PlistProtocolReader {\n  constructor(callback: (data: any) => any) {\n    super(LOCKDOWN_HEADER_SIZE, callback);\n  }\n\n  parseHeader(data: Buffer) {\n    return data.readUInt32BE(0);\n  }\n\n  parseBody(data: Buffer) {\n    const resp = super.parseBody(data);\n    debug(`Response: ${JSON.stringify(resp)}`);\n    if (isLockdownErrorResponse(resp)) {\n      if (resp.Error === 'DeviceLocked') {\n        throw new CommandError('APPLE_DEVICE_LOCKED', 'Device is currently locked.');\n      }\n\n      if (resp.Error === 'InvalidService') {\n        let errorMessage = `${resp.Error}: ${resp.Service} (request: ${resp.Request})`;\n        if (resp.Service === 'com.apple.debugserver') {\n          errorMessage +=\n            '\\nTry reconnecting your device. You can also debug service logs with `export DEBUG=expo:xdl:ios:*`';\n        }\n        throw new CommandError('APPLE_DEVICE_LOCKDOWN', errorMessage);\n      }\n\n      throw new CommandError('APPLE_DEVICE_LOCKDOWN', resp.Error);\n    }\n    return resp;\n  }\n}\n\nexport class LockdownProtocolWriter implements ProtocolWriter {\n  write(socket: Socket, plistData: any) {\n    debug(`socket write: ${JSON.stringify(plistData)}`);\n    const plistMessage = plist.build(plistData);\n    const header = Buffer.alloc(LOCKDOWN_HEADER_SIZE);\n    header.writeUInt32BE(plistMessage.length, 0);\n    socket.write(header);\n    socket.write(plistMessage);\n  }\n}\n"],"mappings":"AAQA;;AAAA,IAAAA,IAAA,GAAAC,OAAA;AAAA,IAAAC,YAAA,GAAAD,OAAA;AAAA,IAAAE,eAAA,GAAAF,OAAA;AAAA,IAAAG,SAAA,GAAAH,OAAA;AAAA,IAAAI,0BAAA,GAAAJ,OAAA;AAAA,IAAAK,eAAA,GAAAL,OAAA;AAAA,SAAAM,aAAAC,OAAA,QAAAC,yBAAA,GAAAC,yBAAA,oBAAAC,qBAAA,QAAAC,KAAA,GAAAN,eAAA,CAAAE,OAAA,GAAAK,MAAA,MAAAJ,yBAAA,QAAAK,SAAA,GAAAR,eAAA,OAAAS,WAAA,EAAAF,MAAA,GAAAG,OAAA,CAAAC,SAAA,CAAAL,KAAA,EAAAM,SAAA,EAAAJ,SAAA,YAAAD,MAAA,GAAAD,KAAA,CAAAO,KAAA,OAAAD,SAAA,YAAAb,0BAAA,OAAAQ,MAAA;AAAA,SAAAH,0BAAA,eAAAM,OAAA,qBAAAA,OAAA,CAAAC,SAAA,oBAAAD,OAAA,CAAAC,SAAA,CAAAG,IAAA,2BAAAC,KAAA,oCAAAC,OAAA,CAAAC,SAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAT,OAAA,CAAAC,SAAA,CAAAK,OAAA,8CAAAI,CAAA;;;;QAoCgBC,kBAAkB,GAAlBA,kBAAkB;QAIlBC,uBAAuB,GAAvBA,uBAAuB;;AAxCrB,IAAAC,MAAa,GAAAC,sBAAA,CAAA7B,OAAA,CAAb,aAAa;AACb,IAAA8B,MAAO,GAAAD,sBAAA,CAAA7B,OAAA,CAAP,OAAO;AAGI,IAAA+B,OAA0B,GAAA/B,OAAA;AAEoB,IAAAgC,iBAAoB,GAAAhC,OAAA;;;;;;AAE/F,IAAMiC,KAAK,GAAG,IAAAH,MAAK,EAAuCI,OAAvC,CAAC,qCAAqC,CAAC;AACnD,IAAMC,oBAAoB,GAAG,CAAC;QAAxBA,oBAAoB,GAApBA,oBAAoB;AAuBjC,SAASC,SAASA,CAACC,GAAQ,EAAE;EAC3B,OAAO,OAAOA,GAAG,KAAK,WAAW;;AAG5B,SAASX,kBAAkBA,CAACY,IAAS,EAA4B;EACtE,OAAOF,SAAS,CAACE,IAAI,CAACC,MAAM,CAAC;;AAGxB,SAASZ,uBAAuBA,CAACW,IAAS,EAAiC;EAChF,OAAOF,SAAS,CAACE,IAAI,CAACE,KAAK,CAAC;;AAC7B,IAEYC,sBAAsB,aAAAC,qBAAA;EAAAvC,SAAA,CAAAsC,sBAAA,EAAAC,qBAAA;EAAA,IAAAC,MAAA,GAAArC,YAAA,CAAAmC,sBAAA;EAGjC,SAAAA,uBAAYG,MAAc,EAAE;IAAA1C,eAAA,OAAAuC,sBAAA;IAAA,OAAAE,MAAA,CAAAnB,IAAA,OACpBoB,MAAM,EAAE,IAAIZ,iBAAqB,CAAAa,qBAAA,CAACC,sBAAsB,CAAC,EAAE,IAAIC,sBAAsB,EAAE;;EAC9F,OAAA9C,YAAA,CAAAwC,sBAAA;AAAA,EAHOT,iBAAc,CAAAgB,cAAA;QAFXP,sBAAsB,GAAtBA,sBAAsB;AAAA,IAQtBK,sBAAsB,aAAAG,qBAAA;EAAA9C,SAAA,CAAA2C,sBAAA,EAAAG,qBAAA;EAAA,IAAAC,OAAA,GAAA5C,YAAA,CAAAwC,sBAAA;EACjC,SAAAA,uBAAYK,QAA4B,EAAE;IAAAjD,eAAA,OAAA4C,sBAAA;IAAA,OAAAI,OAAA,CAAA1B,IAAA,OAClCW,oBAAoB,EAAEgB,QAAQ;;EACrClD,YAAA,CAAA6C,sBAAA;IAAAM,GAAA;IAAAC,KAAA,EAED,SAAAC,YAAYC,IAAY,EAAE;MACxB,OAAOA,IAAI,CAACC,YAAY,CAAC,CAAC,CAAC;;EAC5B;IAAAJ,GAAA;IAAAC,KAAA,EAED,SAAAI,UAAUF,IAAY,EAAE;MACtB,IAAMjB,IAAI,GAAAvC,IAAA,CAAAM,eAAA,CAAAyC,sBAAA,CAAAxB,SAAA,sBAAAE,IAAA,OAAmB+B,IAAI,CAAC;MAClCtB,KAAK,CAAE,aAAYyB,IAAI,CAACC,SAAS,CAACrB,IAAI,CAAE,EAAC,CAAC;MAC1C,IAAIX,uBAAuB,CAACW,IAAI,CAAC,EAAE;QACjC,IAAIA,IAAI,CAACE,KAAK,KAAK,cAAc,EAAE;UACjC,MAAM,IAAIT,OAAY,CAAA6B,YAAA,CAAC,qBAAqB,EAAE,6BAA6B,CAAC;;QAG9E,IAAItB,IAAI,CAACE,KAAK,KAAK,gBAAgB,EAAE;UACnC,IAAIqB,YAAY,GAAI,GAAEvB,IAAI,CAACE,KAAM,KAAIF,IAAI,CAACwB,OAAQ,cAAaxB,IAAI,CAACyB,OAAQ,GAAE;UAC9E,IAAIzB,IAAI,CAACwB,OAAO,KAAK,uBAAuB,EAAE;YAC5CD,YAAY,IACV,oGAAoG;;UAExG,MAAM,IAAI9B,OAAY,CAAA6B,YAAA,CAAC,uBAAuB,EAAEC,YAAY,CAAC;;QAG/D,MAAM,IAAI9B,OAAY,CAAA6B,YAAA,CAAC,uBAAuB,EAAEtB,IAAI,CAACE,KAAK,CAAC;;MAE7D,OAAOF,IAAI;;EACZ;EAAA,OAAAQ,sBAAA;AAAA,EA7ByCd,iBAAmB,CAAAgC,mBAAA;QAAlDlB,sBAAsB,GAAtBA,sBAAsB;AAAA,IAgCtBC,sBAAsB;EAAA,SAAAA,uBAAA;IAAA7C,eAAA,OAAA6C,sBAAA;EAAA;EAAA9C,YAAA,CAAA8C,sBAAA;IAAAK,GAAA;IAAAC,KAAA,EACjC,SAAAY,MAAMrB,MAAc,EAAEsB,SAAc,EAAE;MACpCjC,KAAK,CAAE,iBAAgByB,IAAI,CAACC,SAAS,CAACO,SAAS,CAAE,EAAC,CAAC;MACnD,IAAMC,YAAY,GAAGvC,MAAK,CAAAM,OAAA,CAACkC,KAAK,CAACF,SAAS,CAAC;MAC3C,IAAMG,MAAM,GAAGC,MAAM,CAACC,KAAK,CAACpC,oBAAoB,CAAC;MACjDkC,MAAM,CAACG,aAAa,CAACL,YAAY,CAACM,MAAM,EAAE,CAAC,CAAC;MAC5C7B,MAAM,CAACqB,KAAK,CAACI,MAAM,CAAC;MACpBzB,MAAM,CAACqB,KAAK,CAACE,YAAY,CAAC;;EAC3B;EAAA,OAAApB,sBAAA;AAAA;QARUA,sBAAsB,GAAtBA,sBAAsB"},"metadata":{},"sourceType":"script","externalDependencies":[]}